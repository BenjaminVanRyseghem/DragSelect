var dragSelect=function(e){function t(){O.addEventListener("mousedown",n)}function n(e){b.style.display="block",o(e),c(),O.removeEventListener("mousedown",n),O.addEventListener("mousemove",l),document.addEventListener("mouseup",f)}function o(e){T=v(e),M=w(O);var t={};t.x=T.x+M.x,t.y=T.y+M.y,t.w=0,t.h=0,L(b,t)}function l(t){var n=r(t);L(b,n),c(),e.area&&s(t)}function r(e){var t=v(e),n=w(O),o={x:n.x-M.x,y:n.y-M.y},l={};return t.x>T.x-o.x?(l.x=T.x+M.x,l.w=t.x-T.x+o.x):(l.x=t.x+n.x,l.w=T.x-t.x-o.x),t.y>T.y-o.y?(l.y=T.y+M.y,l.h=t.y-T.y+o.y):(l.y=t.y+n.y,l.h=T.y-t.y-o.y),l}function c(){for(var e=0,t=C.length;e<t;e++){var n=C[e],o=H.indexOf(n);i(n,b)?o<0&&(H.push(n),h(n,"selected"),B(n)):o>-1&&(H.splice(o,1),m(n,"selected"),R(n))}}function i(e,t){var n=w(O),o={y:t.getBoundingClientRect().top+n.y,x:t.getBoundingClientRect().left+n.x,h:t.offsetHeight,w:t.offsetWidth},l={y:e.getBoundingClientRect().top+n.y,x:e.getBoundingClientRect().left+n.x,h:e.offsetHeight,w:e.offsetWidth};return o.x<l.x+l.w&&o.x+o.w>l.x&&o.y<l.y+l.h&&o.h+o.y>l.y}function s(e){var t=u(e);"top"===t&&O.scrollTop>0?O.scrollTop-=1:"bottom"===t?O.scrollTop+=1:"left"===t&&O.scrollLeft>0?O.scrollLeft-=1:"right"===t&&(O.scrollLeft+=1)}function u(e){var t=v(e),n=E(O),o={x:Math.max(n.width/10,20),y:Math.max(n.height/10,20)};return t.y<o.y?"top":n.height-t.y<o.y?"bottom":n.width-t.x<o.x?"right":t.x<o.x&&"left"}function f(){b.style.width="0",b.style.height="0",b.style.display="none",S(H),O.removeEventListener("mousemove",l),O.addEventListener("mousedown",n)}function d(){f(),O.removeEventListener("mousedown",n),document.removeEventListener("mouseup",f)}function a(){return H}function y(e){for(var t=g(e),n=0,o=t.length;n<o;n++){var l=t[n];C.indexOf(l)<0&&C.push(l)}}function x(e){for(var t=g(e),n=0,o=t.length;n<o;n++){var l=t[n];C.indexOf(l)>0&&(m(l,"selected"),C.splice(C.indexOf(l),1))}}function h(e,t){var n=e.className;return-1!==n.indexOf(t)?e:(""!==n&&(t=" "+t),e.className=n+t,e)}function m(e,t){var n=e.className,o=new RegExp(t+"\\b","g");n=n.replace(o,""),e.className=n}function g(e){if(!e)return!1;if(!e.length&&p(e))return[e];for(var t=[],n=e.length-1;n>=0;n--)t[n]=e[n];return t}function p(e){try{return e instanceof HTMLElement}catch(t){return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}}function v(e){var t={x:e.pageX||e.clientX,y:e.pageY||e.clientY},n=E(O);return{x:t.x-n.left,y:t.y-n.top}}function w(e){return{y:e&&e.scrollTop>=0?e.scrollTop:window.scrollY||document.documentElement.scrollTop,x:e&&e.scrollLeft>=0?e.scrollLeft:window.scrollX||document.documentElement.scrollLeft}}function E(e){return{top:e.getBoundingClientRect().top,left:e.getBoundingClientRect().left,bottom:e.getBoundingClientRect().bottom,right:e.getBoundingClientRect().right,width:e.offsetWidth,height:e.offsetHeight}}function L(e,t){return e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.width=t.w+"px",e.style.height=t.h+"px",e}var b,C,B,R,S,T,O,H,M;return function(){b=e.selector||document.getElementById("rectangle"),C=g(e.selectables)||[],B=e.onElementSelect||function(){},R=e.onElementUnselect||function(){},S=e.callback||function(){},O=e.area||document,H=[]}(),t(),{_updatePos:L,isElement:p,toArray:g,removeClass:m,addClass:h,stop:d,isElementTouching:i,reset:f,checkIfInsideSelection:c,handleMove:l,_startUp:n,start:t,getSelection:a,removeSelectables:x,addSelectables:y}};"undefined"!=typeof module&&null!==module?module.exports=dragSelect:window.dragSelect=dragSelect;