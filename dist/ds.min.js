var dragSelect=function(e){function t(){var t=document.createElement("div");return t.style.position="absolute",e.customStyles||(t.style.background="rgba(0, 0, 255, 0.2)",t.style.border="1px solid rgba(0, 0, 255, 0.5)",t.style.display="none"),(W===document?document.body:W).appendChild(t),t}function n(){W.addEventListener("mousedown",o)}function o(e){C.style.display="block",i(e),c(),W.removeEventListener("mousedown",o),W.addEventListener("mousemove",l),document.addEventListener("mouseup",f)}function i(e){H=w(e),k=b(W);var t={};t.x=H.x+k.x,t.y=H.y+k.y,t.w=0,t.h=0,L(C,t)}function l(e){var t=r(e);L(C,t),c(),u(e)}function r(e){var t=w(e),n=b(W),o={x:n.x-k.x,y:n.y-k.y},i={};return t.x>H.x-o.x?(i.x=H.x+k.x,i.w=t.x-H.x+o.x):(i.x=t.x+n.x,i.w=H.x-t.x-o.x),t.y>H.y-o.y?(i.y=H.y+k.y,i.h=t.y-H.y+o.y):(i.y=t.y+n.y,i.h=H.y-t.y-o.y),i}function c(){for(var e=0,t=S.length;e<t;e++){var n=S[e],o=O.indexOf(n);s(n,C)?o<0&&(O.push(n),m(n,"selected"),R(n)):o>-1&&(O.splice(o,1),g(n,"selected"),B(n))}}function s(e,t){var n=b(W),o={y:t.getBoundingClientRect().top+n.y,x:t.getBoundingClientRect().left+n.x,h:t.offsetHeight,w:t.offsetWidth},i={y:e.getBoundingClientRect().top+n.y,x:e.getBoundingClientRect().left+n.x,h:e.offsetHeight,w:e.offsetWidth};return o.x<i.x+i.w&&o.x+o.w>i.x&&o.y<i.y+i.h&&o.h+o.y>i.y}function u(e){var t=d(e),n=W===document?W.body:W;"top"===t&&n.scrollTop>0?n.scrollTop-=1:"bottom"===t?n.scrollTop+=1:"left"===t&&n.scrollLeft>0?n.scrollLeft-=1:"right"===t&&(n.scrollLeft+=1)}function d(e){var t=w(e),n=E(W),o={x:Math.max(n.width/10,20),y:Math.max(n.height/10,20)},i=W===document?b(document.body):{x:0,y:0};return t.y<o.y+i.y?"top":n.height-t.y+i.y<o.y?"bottom":n.width-t.x+i.x<o.x?"right":t.x<o.x+i.x&&"left"}function f(){C.style.width="0",C.style.height="0",C.style.display="none",T(O),W.removeEventListener("mousemove",l),W.addEventListener("mousedown",o)}function y(){f(),W.removeEventListener("mousedown",o),document.removeEventListener("mouseup",f)}function a(){return O}function x(e){for(var t=p(e),n=0,o=t.length;n<o;n++){var i=t[n];S.indexOf(i)<0&&S.push(i)}}function h(e){for(var t=p(e),n=0,o=t.length;n<o;n++){var i=t[n];S.indexOf(i)>0&&(g(i,"selected"),S.splice(S.indexOf(i),1))}}function m(e,t){var n=e.className;return-1!==n.indexOf(t)?e:(""!==n&&(t=" "+t),e.className=n+t,e)}function g(e,t){var n=e.className,o=new RegExp(t+"\\b","g");n=n.replace(o,""),e.className=n}function p(e){if(!e)return!1;if(!e.length&&v(e))return[e];for(var t=[],n=e.length-1;n>=0;n--)t[n]=e[n];return t}function v(e){try{return e instanceof HTMLElement}catch(t){return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}}function w(e){var t={x:e.pageX||e.clientX,y:e.pageY||e.clientY},n=E(W);return{x:t.x-n.left,y:t.y-n.top}}function b(e){return{y:e&&e.scrollTop>=0?e.scrollTop:0,x:e&&e.scrollLeft>=0?e.scrollLeft:0}}function E(e){if(e===document){var t={y:e.documentElement.clientHeight>0?e.documentElement.clientHeight:window.innerHeight,x:e.documentElement.clientWidth>0?e.documentElement.clientWidth:window.innerWidth};return{top:0,left:0,bottom:0,right:0,width:t.x,height:t.y}}return{top:e.getBoundingClientRect().top,left:e.getBoundingClientRect().left,bottom:e.getBoundingClientRect().bottom,right:e.getBoundingClientRect().right,width:e.offsetWidth,height:e.offsetHeight}}function L(e,t){return e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.width=t.w+"px",e.style.height=t.h+"px",e}var C,S,R,B,T,H,W,O,k;return function(){S=p(e.selectables)||[],R=e.onElementSelect||function(){},B=e.onElementUnselect||function(){},T=e.callback||function(){},W=e.area||document,C=e.selector||t(),m(C,"ds-selector"),O=[]}(),n(),{_updatePos:L,isElement:v,toArray:p,removeClass:g,addClass:m,stop:y,isElementTouching:s,reset:f,checkIfInsideSelection:c,handleMove:l,_startUp:o,start:n,getSelection:a,removeSelectables:h,addSelectables:x}};"undefined"!=typeof module&&null!==module?module.exports=dragSelect:window.dragSelect=dragSelect;